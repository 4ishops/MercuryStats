##Работа с электросчетчиком Меркурий 200.02 через RS485

Общее
--
Электросчетчик подключен через usb-485 адаптер к роутеру wl500g на котором по cron-у запускается скрипт, который
получает данные с устройства и отправляет их на xively для рисования графиков.
https://xively.com/feeds/19249442

Реверсим протокол
--
Для работы необходимо знать адрес счетчика. Для 200.02 это последние 6 цифр серийного номера.
В моем случае это 411486 (в десятичном представлении)
06 47 5E - адрес счетчика в HEX

**Запрос**

Заголовок| Адрес счетчика | Команда | CRC16 (Modbus) 
 :---: | :---: | :---: | :---: 
`1 байт` | `3 байта` | `1 байт` | `2 байта`
00 | 06 47 5E |  |

**Ответ**

Заголовок| Адрес счетчика | Команда на которую отвечаем | Ответ | CRC16 (Modbus) 
 :---: | :---: | :---: | :---: | :---: 
`1 байт` | `3 байта` | `1 байт` | |`2 байта`
00 | 06 47 5E | 

**Команды и Ответы**

Команда |  Описание |  Байты ответа
 :---: | :---: | :---:
00 06 47 5E 63 EC D4 | мгновенные значения
00 06 47 5E 21 6C E5 | дата время текущее
00 06 47 5E 24 AC E6 |
00 06 47 5E 25 6D 26 |
00 06 47 5E 27 EC E7 | энергия | 3 байта тариф1, 3 байта тариф2,3 байта тариф3, 3 байта тариф4                         
00 06 47 5E 2F ED 21 | служебная информация                                                      
00 06 47 5E 65 6C D6 | служебная информация                                
00 06 47 5E 2C AD 20 | служебная информация                                 
00 06 47 5E 2B EC E2 | служебная информация                                 
00 06 47 5E 87 EC 9F | служебная информация                                 
00 06 47 5E 29 6D 23 | напряжение батарейки | 1 байт вольт, 1 байт десятой части
00 06 47 5E 66 2C D7 | дата изготовления | байт адреса, байт месяца, байт года
00 06 47 5E 2A 2D 22 | индикация на дисплее
00 06 47 5E 67 ED 17 | индикация на дисплее                           
00 06 47 5E 28 AC E3 | версия | байт версии, байт подверсии
00 06 47 5E 31 00 E8 | тарифное расписание
00 06 47 5E 23 ED 24 | лимит энергии | 9999 квт*ч
00 06 47 5E 22 2C E4 | лимит мощности | 99990 Вт
00 06 47 5E 26 2D 27 | чтение мощности                             
00 06 47 5E 2D 6C E0 | функция испульсного выхода чтение                             
00 06 47 5E 25 6D 26 | коррекция времени кнопками                           
00 06 47 5E 24 AC E6 | флаг перехода зимнее.летнее
